---
layout: default
title: 파일 카빙
parent: 포렌식
grand_parent: 보안
nav_order: 2
---

# 파일 카빙 (File Carving)
{: .fs-8 }

14.2 포렌식
{: .label .label-purple }

---

## 핵심 키워드

`연속적 카빙` `비연속적 카빙` `시그니처 기반` `램 슬랙` `파일 구조체` `엔트로피`

---

## 정의/개념

저장 매체 포맷 또는 파일 시스템 손상 발생 시, **메타데이터 없이 미존재 파일을 복구**하기 위해 시도하는 기법

---

## 파일 카빙 유형

```
                    ┌─────────────────┐
                    │   파일 카빙 기술   │
                    └────────┬────────┘
                             │
        ┌────────────────────┼────────────────────┐
        │                    │                    │
┌───────┴───────┐    ┌───────┴───────┐    ┌───────┴───────┐
│  시그니처 기반  │    │    램 슬랙     │    │   파일 구조체   │
└───────┬───────┘    └───────────────┘    └───────┬───────┘
        │                                          │
┌───────┴───────┐                        ┌────────┴────────┐
│ 파일 크기 획득 │                        │  파일 구조 검증  │
│    방법        │                        │      방법       │
└───────────────┘                        └─────────────────┘
```

---

## 카빙 기법 분류

### 연속적 기법

| 기법 | 상세 내용 |
|:-----|:----------|
| **헤더/푸터 카빙** | 파일은 고유한 헤더(Header)와 푸터(Footer) 시그니처를 이용 |
| **램 슬랙 카빙** | 윈도우 시스템에서 램 슬랙이 항상 0x00으로 채워지는 성질 이용 |
| **파일 크기 카빙** | 헤더만 존재하고 푸터 시그니처가 없는 파일에 효과적<br>헤더 구조체 내용을 기반으로 파일 크기를 획득하거나 계산 |
| **파일 검증 카빙** | 헤더만 존재하고 파일 크기 정보를 얻기 어려운 파일에 적용<br>파일 내부검증을 통해 App수준에서 확인이 가능한 선으로 복구 |

### 비연속적 기법

| 기법 | 상세 내용 |
|:-----|:----------|
| **시그니처 탐색** | 모든 파일 포맷에 적용하기 어려움, 오탐이 많이 발생 |
| **엔트로피** | 블록/클러스터의 엔트로피를 계산해 특정 파일의 조각을 분류 |
| **바이트 분포** | 다수 파일에서 측정 결과를 기반으로 기준을 선정하고 기준점과의 거리 측정을 통해 검색 |
| **바이트 편차** | 인접한 바이트들 간의 편차를 이용한 방식 |

---

## 카빙 기법 상세

| 구분 | 특징 | 설명 |
|:-----|:-----|:-----|
| **시그니처 기반** | Header, Footer 이용 | - 파일의 포맷 별로 존재하는 파일 시그니처를 이용하는 방법<br>- 파일 확장자를 변경했어도 파일 헤더에서 확인한 시그니처는 원래 확장자를 그대로 갖고 있기 때문에 시그니처를 이용해 식별함 |
| **램 슬랙** | Ram slack 0x00 이용 | - 파일의 내용을 디스크에 기록할 때 512의 배수가 되지 않아 생긴 0x00 영역을 램 슬랙이라고 하는데 대부분 Footer 시그니처 이후에 램 슬랙이 존재하며 이 범용으로 Footer 시그니처와 램 슬랙을 확인할 수 있음 |
| **파일 크기 획득 방법** | 각 파일의 헤더 구조체 이용 | - 파일의 구조체 안에 파일의 크기를 알려주는 부분이 존재<br>- exe나 dll 파일 같은 경우 PE파일 안에 파일 크기가 들어가 있어서 E 헤더를 찾아서 파일 크기를 획득 할 수 있음 |
| **파일 구조 검증 방법** | 파일 계층 구조 이용 | - 문서 파일처럼 수정이 잦은 경우 데이터 표현을 위해 고유한 계층 구조를 사용함<br>- 이 방법은 이런 계층 구조를 검증해서 카빙하는 방식<br>- 특히 마이크로소프트 복합 문서나 압축 파일 같은 경우 계층 구조마다 고유한 시그니처가 존재<br>- 따라서 파일의 계층 구조를 확인해 가며 올바른 구조라면 정상적인 파일이라고 판단할 수 있음 |

---

## 연계 토픽

- [디지털 포렌식](/docs/sec/14-forensic/digital-forensic)
- [파일 슬랙](/docs/sec/14-forensic/file-slack)
- [디스크 이미징](/docs/sec/14-forensic/disk-imaging)
- [안티 포렌식](/docs/sec/14-forensic/anti-forensic)

---

## 학습 체크리스트

- [ ] 파일 카빙의 정의 이해
- [ ] 연속적/비연속적 카빙 기법 구분
- [ ] 시그니처 기반, 램 슬랙, 파일 구조체 방식 차이점 이해

---

## 참고자료

- 정보관리기술사 보안 학습자료

