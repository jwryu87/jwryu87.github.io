---
layout: default
title: 이중서명
parent: 전자서명
grand_parent: 보안
nav_order: 3
---

# 이중서명 (Dual Signature)
{: .fs-8 }

20.3 전자서명
{: .label .label-purple }

---

## 핵심 키워드

`구매정보` `지불정보` `연접` `해시` `공개키` `개인키` `비밀키` `전자서명` `전자봉투` `기밀성` `무결성`

---

## 정의/개념

구매정보와 지불정보에 대한 해시값을 자신의 **개인키로 암호화하는 방식**으로 구매 정보와 지불 정보를 **각각 다른 키로 암호화**하여 판매자는 구매정보만, PG사는 지불정보만 알 수 있도록 하는 서명기술

---

## 송신절차

```
┌──────────────────────────────────────────────────────────────────┐
│                                                                  │
│     ┌─────────────┐    해시    ┌──────────────┐                 │
│     │   구매정보   │──────────▶│      M1      │                 │
│     │             │           │   (해시값)    │────┐            │
│     └─────────────┘           └──────────────┘    │            │
│                                                    │            │
│                                        ┌───────────┘            │
│                                        │                        │
│                                        ▼                        │
│                               ┌────────────────┐                │
│                               │       M        │                │
│                               │    (해시값)    │───▶ 이중서명   │
│                               │      연접      │       │       │
│                               └────────────────┘       │       │
│                                        ▲               │       │
│                                        │      사용자의  │       │
│                                        │      개인키   │       │
│     ┌─────────────┐    해시    ┌───────┴──────┐       │       │
│     │   지불정보   │──────────▶│      M2      │       │       │
│     │             │           │   (해시값)    │───────┘       │
│     └─────────────┘           └──────────────┘                │
│                                                                  │
│                                    "연접"                        │
│                                                                  │
└──────────────────────────────────────────────────────────────────┘
```

### 이중서명 생성 절차

| No | 수행절차 | 설명 |
|:---|:---------|:-----|
| ① | 이중서명 생성 | - 구매 정보 및 결제 정보를 메시지 다이제스트 M1, M2 생성<br>- M1, M2를 연접 및 해시함수 이용 M 생성<br>- M을 사용자의 개인키로 전자서명 |
| ② | 전자봉투 생성 | - 비밀키로 결제 정보 암호화, PG사의 공개키로 비밀키 암호화<br>- 구매/암호화 결제정보, M1/M2, 전자서명, 전자봉투 전송 |

---

## 수신절차

### 구매정보 확인 (판매자)

| No | 수행절차 | 설명 |
|:---|:---------|:-----|
| ③ | 구매정보 확인 | - M1/M2의 M1을 M1'으로 대체 및 M' 생성<br>- M == M' 검증후 결제정보/M1M2 PG사 전송 |

### 결제정보 확인 (PG사)

| No | 수행절차 | 설명 |
|:---|:---------|:-----|
| ④ | 결제정보 확인 | - 개인키를 이용하여 전자봉투 복호화 및 비밀키 획득<br>- 비밀키 기반 결제정보/M1M2/전자서명 값 추출<br>- 결제정보 해시 M2' 생성 및 M1/M2의 M2를 M2'로 대체 및 M1 생성<br>- 사용자 공개키 기반 M 추출 및 M == M' 검증 |

---

## 이중서명 특징

| 특징 | 설명 |
|:-----|:-----|
| **정보 분리** | 판매자는 구매정보만, PG사는 결제정보만 확인 가능 |
| **기밀성** | 각각의 정보가 해당 수신자에게만 공개 |
| **무결성** | 해시값을 통한 변조 여부 확인 |
| **부인방지** | 전자서명을 통한 송신자 인증 |

---

## 활용

| 분야 | 설명 |
|:-----|:-----|
| **SET 프로토콜** | 전자상거래에서 이중서명 사용 |
| **전자결제** | 구매자-판매자-PG사 간 안전한 거래 |

---

## 연계 토픽

- [전자서명](/docs/sec/20-digital-signature/)
- [전자봉투](/docs/sec/20-digital-signature/digital-envelope)
- [PKI](/docs/sec/20-digital-signature/pki)
- [해시 함수](/docs/sec/10-cryptography/hash-function)

---

## 학습 체크리스트

- [ ] 이중서명의 정의와 목적 이해
- [ ] 송신절차 (이중서명 생성, 전자봉투 생성) 이해
- [ ] 수신절차 (구매정보 확인, 결제정보 확인) 이해

---

## 참고자료

- 정보관리기술사 보안 학습자료

