---
layout: default
title: 전자봉투
parent: 전자서명
grand_parent: 보안
nav_order: 2
---

# 전자봉투 (Digital Envelope)
{: .fs-8 }

20.2 전자서명
{: .label .label-purple }

---

## 핵심 키워드

`전자서명` `공개키` `비밀키` `Hash` `Message Digest`

---

## 정의/개념

공개키 인프라를 이용해 **비밀키를 수신자의 공개키로 암호화함**으로써 온라인 상에서 **기밀성 있는 통신이 가능한 암호화 기술**

---

## 송신절차

```
                                              ③
                              ┌───────────┐  비밀키로
      ┌───────────────────────│           │  암호화   ┌────────┐
      │          ①           │           │─────────▶│ 암호문 │────▶ ⑤
      │       해시함수        │           │          └────────┘   전송
      │          │            └───────────┘
      │          ▼                                    ┌────────────┐
      │    ┌──────────┐  ②   ┌──────────────┐        │            │
      │    │ Message  │────▶│  전자서명    │        │  전자봉투   │
      │    │  Digest  │      │ (암호화된    │────────▶│            │
      │    │          │      │  Message     │        │            │
      │    └──────────┘      │  Digest)     │        └────────────┘
      │                       └──────────────┘               │
      │         송신자의                           ④        │
      │         개인키로                      비밀키(대칭키)를│
      │          암호화                       송신자의 공개키로│
      │                                         암호화        │
      │                       ┌──────────────┐               │
      │                       │              │               │
      └──────────────────────▶│ 송신자의     │◀──────────────┘
                              │   인증서     │
                              │              │
                              └──────────────┘

       송신자   비밀키   수신자
       개인키  (대칭키)  공개키
```

### 송신 절차 상세

| 절차 | 설명 |
|:-----|:-----|
| **1. Message Digest 생성** | 메시지를 해시함수로 축약, Message Digest 생성 |
| **2. 전자서명 생성** | 송신자의 개인키(Private Key)로 Message Digest를 암호화 한 전자서명 생성 |
| **3. 비밀키(Secret Key)로 암호** 문 생성 | 비밀키(대칭키)를 사용하여 전자서명과 메시지와 송신자의 공개키가 들어 있는 인증서를 암호화하여 암호문 생성 |
| **4. 전자봉투 생성** | 수신자의 공개키(Public Key)로 비밀키를 암호화하는데, 이 암호화된 비밀키가 전자봉투가 됨 |
| **5. 암호문과 전자봉투 전송** | 송신자는 최종적으로 비밀키로 암호화된 전자서명과 전자봉투를 수신자에게 전송 |

- 송신자의 개인키로 전자서명을 생성, 수신자의 공개키로 전자봉투를 생성하여 전송

---

## 수신절차

```
                                                         해시생성
                        ②                              ┌────────┐
                    ┌───────┐    비밀키로               │        │  해시값
     암호문         │       │◀─────────    ┌──────────▶│        │────────▶ ║ 비교 ④
       │           │  해독  │             │           │        │          ║
       │           └───────┘             │           └────────┘          ║
       │               │                  │                               ║
       ▼               ▼                  │               ③              ║
  ┌─────────┐    ┌──────────┐            │           ┌────────┐         ║
  │         │    │  전자서명 │    ①      │           │Message │         ║
  │ 전자봉투 │    │ (암호화된 │◀─────────┘           │ Digest │◀────────║
  │         │    │  Message │                       │        │          ║
  │         │    │  Digest) │                       └────────┘          ║
  └────┬────┘    └──────────┘                            ▲              ║
       │               │                                 │              ║
       │               │                          송신자의              ║
       │         수신자의                         공개키로              ║
       │         개인키로                           해독               ║
       │           해독                                                 ║
       ▼                                                                ║
  ┌─────────┐                                                          ║
  │ 비밀키  │                                           송신자의 인증서  ║
  │  획득   │                                                          ║
  └─────────┘                                                          ║
       │                                                                ║
       │            수신자   비밀키   송신자                             ║
       │            개인키  (대칭키)  공개키                             ║
       │                                                                ║
       └────────────────────────────────────────────────────────────────┘
```

### 수신 절차 상세

| 절차 | 설명 |
|:-----|:-----|
| **1. 전자봉투 복호화** | 전달받은 전자봉투를 수신자의 개인키로 복호화 하여 비밀키(대칭키)를 획득 |
| **2. 암호문 복호화** | 비밀키(대칭키)를 이용해 암호문을 복호화 하여 전자서명과 메시지, 송신자의 인증서를 획득 |
| **3. 전자서명 복호화** | 획득한 송신자 인증서의 송신자 공개키를 이용해 전자서명을 복호화 하여 Message Digest 획득 |
| **4. 무결성 검증** | 메시지의 해시값과 Message Digest를 비교해 무결성 검증 |

- 전자봉투를 통해 전자서명의 위조불가, 부인지, 서명자 인증, 변경불가, 재사용 불가와 함께 기밀성 제공

---

## 연계 토픽

- [PKI](/docs/sec/20-digital-signature/pki)
- [이중서명](/docs/sec/20-digital-signature/dual-signature)
- [해시 함수](/docs/sec/10-cryptography/hash-function)

---

## 학습 체크리스트

- [ ] 전자봉투의 정의와 목적 이해
- [ ] 송신절차 5단계 이해
- [ ] 수신절차 4단계 이해

---

## 참고자료

- 정보관리기술사 보안 학습자료

