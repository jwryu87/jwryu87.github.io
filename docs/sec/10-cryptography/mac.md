---
layout: default
title: MAC (메시지 인증 코드)
parent: 암호화
grand_parent: 보안
nav_order: 5
---

# MAC (Message Authentication Code)
{: .fs-8 }

10.5 암호화
{: .label .label-purple }

---

## 핵심 키워드

`메시지 무결성` `비밀키 공유` `HMAC` `CMAC` `신원 인증`

---

## 정의/개념

MDC 인증 단점 보완, **메시지 무결성, 신원 인증, 비밀키 공유 인증 기술**

- 키를 사용하는 해시 함수 기반 무결성 + 인증 검증 방식

---

## 메커니즘

### MAC 동작 과정

```
┌─────────────────────────────────────────────────────────────┐
│                                                             │
│  ① 메시지 ──────────────> ③ 메시지 ──> ① 키 교환           │
│      │                        │                             │
│      ↓                        ↓                             │
│  ② 비밀키                 ② MAC 계산                        │
│      │                        │                             │
│  ┌─Hash─┐                ③ 메시지 전송                      │
│  │      │                     │                             │
│  └──────┘                 ④ MAC 계산                        │
│      │                        │                             │
│  ┌─MAC──┐                 ⑤ MAC 비교                        │
│  │      │                     │                             │
│  └──────┘    무결성           ↓                             │
│      │      ←───────── ⑥ 결과 검토                          │
│                                                             │
└─────────────────────────────────────────────────────────────┘

- 비밀키 방식, 사전 공유 필요, "부인방지 불가"
```

---

## 프로세스

| 구분 | # | 프로세스 |
|:-----|:--|:---------|
| **사전** | 1 | 키 교환 (비밀키 공유) |
| **송신측** | 2 | MAC 계산 |
| | 3 | 메시지 전송 |
| **수신측** | 4 | MAC 계산 |
| | 5 | MAC 비교 |
| | 6 | 결과 검토 |

---

## 알고리즘

| 유형 | 핵심 | 특징 |
|:-----|:-----|:-----|
| **Nested MAC** | 2회 Hashing | 2단계 해시 과정, 2개 키 존재 |
| **HMAC (Hash)** | 일방향 해시함수 이용 | 계산 Padding 포함 |
| **CMAC (Cipher)** | 블록 암호 기반 | CBC-MAC 보안 결함 수정 |

---

## MAC의 특징

| 특징 | 설명 |
|:-----|:-----|
| **키 사용** | 송/수신자 간 공유 비밀키 필요 |
| **무결성** | 메시지 변조 여부 확인 |
| **인증** | 송신자 신원 확인 가능 |
| **부인방지 불가** | 비밀키 공유로 부인방지 미제공 |

---

## MDC vs MAC 비교

| 구분 | MDC | MAC |
|:-----|:----|:----|
| **키 사용** | 미사용 | **사용** |
| **무결성** | ○ | ○ |
| **인증** | ✕ | **○** |
| **부인방지** | ✕ | ✕ |
| **알고리즘** | MD5, SHA | HMAC, CMAC |
| **속도** | 빠름 | 상대적 느림 |

---

## HMAC 동작 원리

```
            ┌──────────────────────────────────────┐
            │                                      │
  Key ──────┼────> ipad XOR ──────┐                │
            │                     │                │
  Message ──┼─────────────────────┼──> Hash ──────┐│
            │                     │               ││
  Key ──────┼────> opad XOR ──────┼───────────────┼┼──> Hash ──> HMAC
            │                                     ││
            └─────────────────────────────────────┘│
                                                   │
            └──────────────────────────────────────┘

ipad: Inner Padding (0x36)
opad: Outer Padding (0x5C)
```

---

## 활용 분야

| 분야 | 설명 |
|:-----|:-----|
| **API 인증** | API 요청 무결성 검증 |
| **SSL/TLS** | 핸드쉐이크 무결성 |
| **IPsec** | 패킷 인증 |
| **JWT** | 토큰 서명 |

---

## 연계 토픽

- [MDC](/docs/sec/10-cryptography/mdc)
- [해쉬 함수](/docs/sec/10-cryptography/hash-function)
- [전자서명](/docs/sec/20-digital-signature/)

---

## 학습 체크리스트

- [ ] MAC 메커니즘 이해
- [ ] MDC vs MAC 차이점 파악
- [ ] HMAC, CMAC 알고리즘 특징 이해

---

## 참고자료

- 정보관리기술사 보안 학습자료

