---
layout: default
title: 137회-4교시-1번 BPFdoor 악성코드
parent: 📝 기출문제
grand_parent: SEC (정보보안)
nav_order: 137401
permalink: /docs/sec/exam/137-4-1-bpfdoor
---

# BPFdoor 악성코드
{: .no_toc }

137회 정보관리기술사 4교시 1번
{: .label .label-blue }

보안 / 난이도: 상
{: .label .label-yellow }

2교시형 (서술형)
{: .label .label-red }

---

## 📚 목차
{: .no_toc .text-delta }

- [🎓 고딩 수준 설명](#-고딩-수준-설명)
- [🎯 기술사 수준 설명](#-기술사-수준-설명)

---

<details markdown="1">
<summary><h2 style="display:inline" id="-고딩-수준-설명">🎓 고딩 수준 설명 (클릭해서 펼치기)</h2></summary>

### 🔑 핵심 키워드 3개
- **BPF**: 리눅스에서 네트워크 패킷을 필터링하는 기술
- **매직 패킷**: 특정 신호를 보내면 깨어나는 비밀 명령
- **포트리스**: 포트를 열지 않고 몰래 통신

### 📖 등장배경

> 2025년 4월 SKT 개인정보 유출사고에서 BPFdoor가 사용됐어요. 기존 백도어는 특정 포트를 열어서 연결하는데, BPFdoor는 **포트를 열지 않고도 몰래 명령을 받을 수 있어서** 방화벽이나 보안 장비가 탐지하기 매우 어려워요!

### 📝 개념 정의

> BPFdoor는 **"리눅스의 BPF 기능을 악용해서 포트를 열지 않고도 원격 명령을 실행하는 스텔스 백도어"**예요.
> 
> 비유하자면, **특별한 노크 소리(매직 패킷)**가 들리면 문을 열어주는 비밀 통로예요!

### 🏗️ 기존 백도어와 비교

| 구분 | 기존 백도어 | BPFdoor |
|:-----|:----------|:--------|
| 포트 | 특정 포트 열어야 함 | 포트 안 열어도 됨 |
| 탐지 | 비교적 쉬움 | 매우 어려움 |
| 동작 | 사용자 공간 | 커널 레벨 |
| 흔적 | 로그 남음 | 흔적 최소화 |

### ⭐ 차별점 키워드

> **SKT 해킹 사고**: 2025년 4월 BPFdoor를 이용한 대규모 개인정보 유출!

</details>

---

## 🎯 기술사 수준 설명
{: #-기술사-수준-설명}

### 📌 핵심 암기 (Quick Reference)

{: .highlight }
> **BPFdoor**: 스텔스, 포트리스, 커널레벨 → BPF 기반 백도어 악성코드
> - (특징) `스메보` (스텔스, 메모리상주, 보안우회)
> - (위협) `탐방은다APT`
> - (대응) `침로보위` + `정보위정`

---

## Ⅰ. BPFdoor의 개념 및 기존 백도어 방식과의 차이점

{: .highlight }
> **BPFdoor 개념**: 스텔스, 포트리스, 커널레벨 → BPF 기반 백도어 악성코드
> - (개념) `BPF 악용, 포트 미개방, 원격 명령 실행`
> - (특징) `스메보` (스텔스, 메모리상주, 보안우회)
> - (차이점) `포트, 탐지, 동작계층, 배포방식`

### 가. BPFdoor의 개념

SKT 개인정보 유출사고('25.4.)에 활용된 **BPFdoor 악성코드의 위협과 대응방안** 숙지 필요

```
┌─────────────────────────────────────────────────────────────────────────┐
│                         BPFdoor 공격 개념도                              │
├────────────────────┬─────────────────────┬──────────────────────────────┤
│      [특징]        │     [공격대상]       │        [공격영향]            │
├────────────────────┼─────────────────────┼──────────────────────────────┤
│ • 보안 솔루션 우회  │                     │ • 서비스 가용성/무결성 저하   │
│ • 커널 레벨 동작   │    Linux 서버       │ • 기업 데이터 유출           │
│ • 포트 미개방 통신  │    및 호스트        │ • 규제 및 법적 리스크 발생    │
│                    │                     │                              │
│   "매직 패킷"      │  Lateral Movement   │                              │
│    → 공격 활성화   │  (내부 확산)        │                              │
└────────────────────┴─────────────────────┴──────────────────────────────┘
```

| 구분 | 내용 |
|:-----|:-----|
| **개념** | BPF를 활용해 네트워크 패킷을 감시하며 외부 명령을 은밀히 수신하고 실행하는 **리눅스 기반 보안시스템 우회 공격기법** |
| **BPF란** | 리눅스 커널 내에서 네트워크 패킷을 캡처하고 필터링하는 데 사용되는 기술 |

| 특징 | 상세 설명 |
|:----|:---------|
| **스텔스 백도어** | 평상시에는 활동이 없다 매직패킷 이후 활성화 |
| **메모리 상주** | BPFdoor는 실행 파일 없이 메모리에서만 동작하여 포렌식 및 AV 탐지 회피 |
| **보안시스템 우회** | 시스템에서 포트를 열지 않기 때문에 방화벽, IDS 탐지 회피 가능 |

### 나. 기존 백도어 방식과의 차이점

**통신방식 측면**

| 구분 | 기존 백도어 | BPFdoor |
|:-----|:----------|:--------|
| 연결 주체 | 감염 시스템이 C&C 서버에 Outbound 접속 | 공격자가 외부에서 Inbound 접근 가능 |
| 데이터 전달 | 주로 HTTP/HTTPS, DNS 등 정상 프로토콜 위장 | BPF 필터를 활용, 특정 패킷 인식으로 명령 전달 |
| 탐지 가능성 | 비정상 외부 연결 패턴·C&C 도메인 탐지로 비교적 용이 | 포트리스(Portless) 동작으로 방화벽·IDS 탐지 회피 |

**은폐 및 보안 회피 측면**

| 구분 | 기존 백도어 | BPFdoor |
|:-----|:----------|:--------|
| 포트 사용 | 특정 포트 리스닝 기반 → 흔적 존재 | 아무 포트에서 은밀히 명령 수신 |
| 로그 흔적 | 접속 기록 및 프로세스 흔적 남기기 쉬움 | 로그 미기록·은폐 처리로 장기간 탐지 회피 |
| 은폐 수준 | 상대적으로 낮음 | 커널 수준 은폐 → 고은폐·고지속성(Persistent) |

**상세 비교**

| 구분 | BPFdoor | 기존 백도어 |
|:-----|:--------|:----------|
| 개념 | BPF 기능 악용, NW 포트 개방 없이 원격지 명령 실행하는 고도화된 백도어형 악성코드 | 특정 NW 포트나 C2(Command&Control) 연결로 공격자의 원격 명령을 실행하는 악성 프로그램 |
| 공격대상 | 주로 Linux 서버 및 호스트 (커널에서 eBPF 지원이 되는 시스템) | Windows/Linux/macOS 등 다양한 플랫폼의 서버 및 호스트 |
| 네트워크 채널 | 포트 미개방, 매직패킷 기반 간접 채널 활용 | 특정 포트 개방 필요, 아웃바운드 C2(Command&Control) |
| 탐지 난이도 | 매우 높음 (커널 후킹, 로그 흔적 최소화) | 상대적으로 낮음 (포트, 프로세스, 파일 흔적으로 탐지) |
| 동작계층 | 커널 레벨(eBPF 프로그램) | 사용자 공간(User Space) |
| 배포방식 | 초기 침투 후 권한 상승 | 피싱, 취약점 악용 등으로 자동 전파 |
| 방화벽 우회 | 매직패킷으로 정책우회 용이 | 포트 차단 정책으로 방어 가능 |

> BPFdoor는 전통적인 백도어처럼 포트를 열어 두거나 C2 서버와 주기적 통신을 하지 않고, **BPF를 이용해 특정 패킷을 감지해 은밀히 동작하는 백도어**라는 점에서 기존 방식과 큰 차이를 보임

---

## Ⅱ. BPFdoor의 위협 요소와 기업 시스템에 미치는 영향

{: .highlight }
> **BPFdoor 위협**: 탐지회피, 방화벽우회, APT연계 → 고도화된 백도어 위협
> - (위협요소) `탐방은다APT` (탐지회피, 방화벽우회, 은닉성, 다양성, APT연계)
> - (보안체계) `보안솔루션 우회, 원격명령 채널 은닉, 흔적 최소화`
> - (시스템영향) `가용성 저하, 데이터 유출, 법적 리스크`

### 가. BPFdoor의 위협 요소 `탐방은다APT`

| 위협 요소 | 설명 |
|:---------|:-----|
| **탐**지 회피 능력 | 포트 리스닝·C2 비콘 없이 BPF를 활용해 네트워크 패킷 감지 → IDS/IPS 탐지 회피 |
| **방**화벽 우회 | TCP/UDP/ICMP 등 다양한 프로토콜 패킷을 직접 가로채 방화벽 규칙 무력화 |
| **은**닉성·지속성 | 매직 패킷 도착 전까지 수면 상태, 서비스 등록·루트킷 기법으로 재부팅 후에도 실행 |
| **다**양한 악성 기능 | Reverse shell, Proxy, 파일 전송, 명령 실행 등 공격자에게 서버 제어권 제공 |
| **APT** 연계 가능성 | 국가 지원형 APT 그룹이 장기 침투·정보 수집용으로 활용 |

### 나. 기업 시스템에 미치는 영향

**보안체계 무력화**

| 구분 | 위협요소 | 설명 |
|:-----|:--------|:-----|
| 보안체계 무력화 | 기존 보안솔루션 우회 | 방화벽, IDS/IPS 등의 보안 정책 룰 회피 |
| | 원격명령 채널 은닉 | 포트 개방 없이 매직패킷으로 명령 활성화 |
| | 로그·파일·프로세스 흔적 최소화 | 메모리, 커널 매핑 기반 동작으로 흔적 최소화 |
| 침해사고 파급 | Lateral Movement로 공격 확산 | 커널 권한 악용으로 조직 내부로 공격대상 확산 |
| | 데이터 유출규모 파악 난해 | 정상 트래픽으로 위장하여 실제 유출범위 추적 곤란 |
| | 공급망 리스크 증가 | 인프라 연계 지점 침해 시 공급망 전반 리스크 증대 |

**시스템·비즈니스 측면 영향**

| 구분 | 영향 요소 | 설명 |
|:-----|:---------|:-----|
| **시스템 측면** | 서비스 가용성·무결성 저하 | 커널 동작 변조로 서비스 지연, 오류 발생 가능 |
| | 모니터링 사각지대 발생 | 은닉 기반 활동으로 EDR/IPS 등이 이상행위 포착 실패 |
| | 포렌식 및 원인규명 곤란 | 흔적 최소화, 변조로 침해경로 및 영향 추적 난해 |
| | 기업 데이터 유출 | 민감 데이터의 은밀한 유출 |
| **비즈니스 측면** | 복구 및 사고대응 비용 증가 | 커널 무결성 복구, 재설치, 법적 대응 등 비용 증가 |
| | 비즈니스 연속성 위협 | 핵심 서비스 중단 리스크 발생 가능 |
| | 규제 및 법적 리스크 발생 | 과징금, 행정처분, 소송 등 법적 제재 발생 |
| | 기업 가치 및 고객신뢰 저하 | 브랜드 이미지 손상 및 고객이탈 초래 |

> BPFdoor는 탐지 회피·방화벽 우회·APT 연계라는 특수한 위협을 가지고 있으며, 이는 기업에 **정보 유출·서비스 장애·보안체계 붕괴·법적 리스크**까지 이어짐

---

## Ⅲ. BPFdoor의 위협에 대응하기 위한 기술적, 관리적 방안

{: .highlight }
> **BPFdoor 대응**: 기술적 방안, 관리적 방안 → 종합 대응 전략
> - (기술적) `침로보위` (침해탐지, 로그모니터링, 보안패치, 위협인텔리전스)
> - (관리적) `정보위정` (보안정책, 교육인식, 위기대응, 정기점검)
> - (핵심) `행위 기반 탐지, 지속적 패턴 업데이트`

### 가. 기술적 대응 방안 `침로보위`

| 구분 | 주요 대응방안 | 세부 내용 |
|:-----|:-----------|:---------|
| **탐지 및 차단** | **침**해 탐지·차단 강화 | NDR/EDR/XDR 기반 이상 행위 탐지, 비정상 패킷 패턴 룰 강화 |
| | **로**그·패킷 모니터링 | BPF 동작 모니터링, 시스템콜·네트워크 소켓 로그 분석 |
| | **보**안 패치·시스템 강화 | 커널·BPF 보안 패치 적용, 불필요한 BPF 기능 제한, 권한 최소화 |
| | **위**협 인텔리전스 활용 | IOC 업데이트, MITRE ATT&CK 기반 탐지·대응 시나리오 적용 |

**상세 기술적 대응**

| 구분 | 위협요소 | 설명 |
|:-----|:--------|:-----|
| 탐지 및 차단 | 침해지표(IoC) 기반 탐지·차단 | 알려진 eBPF 관련 IoC의 SIEM/ESR에 연동 |
| | 비정상 NW 트래픽 탐지 강화 | 매직패킷, 패킷 패턴, 비정상 타이밍 등을 룰 기반 탐지 |
| | 보안솔루션 탐지 우회 감시 | EDR 우회 시도를 별도 룰로 감시 |
| 예방 및 하드닝 | 패치 및 시스템 업데이트 | 커널, OS, 라이브러리 최신 보안패치 적용 |
| | 접근통제 강화 최소권한 원칙 적용 | 민감 권한 부여를 엄격히 통제, 관리자 계정 사용 최소화 |
| | 파일 무결성 검증 및 모니터링 강화 | 주요 바이너리, 커널모듈, 설정파일 무결성 검증으로 감시 |

### 나. 관리적 대응 방안 `정보위정`

| 구분 | 주요 대응방안 | 세부 내용 |
|:-----|:-----------|:---------|
| **보안관리 강화** | 보안 **정**책·절차 수립 | 비인가 BPF 사용 금지 정책, 접근통제 정책 주기적 점검 |
| | 보안 교육·인식 제고 | 관리자·운영자 대상 BPFdoor 위협 및 대응 교육 |
| **인적 보안 강화** | **위**기 대응 체계 강화 | CSIRT 운영, KISA·관제센터 등 유관기관과 공동 대응 체계 구축 |
| | **정**기 점검·모의훈련 | 정기 취약점 진단, 모의 해킹·침투 테스트로 대응력 점검 |

**상세 관리적 대응**

| 구분 | 위협요소 | 설명 |
|:-----|:--------|:-----|
| 보안관리 강화 | 로그 분석 및 장기 보관 | syslog 서버 등 시스템 로그 별도 보관 및 분석체계 정립 |
| | eBPF 침해 사고대응 정책 수립 | 사고대응 Playbook 문서화 및 대응 절차 수립 |
| 인적 보안 강화 | 정기적 보안점검 및 레드티밍 | BPFdoor 악성코드 공격 대응 모의훈련 및 해킹훈련 수행 |
| | 내부 인력 보안인식 교육 | 내부 인력 전문교육으로 보안 관리 및 대응 능력 배양 |

> 행위 기반 탐지 체계 강화와 지속적 패턴 업데이트가 대응의 핵심

---

## Ⅳ. 결론 및 향후 전망

{: .highlight }
> **BPFdoor 대응 전략**: 기술적 대응, 관리적 대응 → 종합 보안 체계
> - (기술적) `IoC 탐지, 실시간 모니터링, 패치 강화, 인텔리전스`
> - (관리적) `정책 수립, 교육, CSIRT, 모의훈련`
> - (향후) `보안솔루션 침해지표 반영, 사고 예방·대응 능력 강화`

```
┌─────────────────────────────────────────────────────────────────────────┐
│                    BPFdoor 대응 전략 프레임워크                          │
├─────────────────────────────────────┬───────────────────────────────────┤
│           기술적 대응                │           관리적 대응             │
├─────────────────────────────────────┼───────────────────────────────────┤
│ • 침해지표(IoC) 기반 탐지           │ • 보안 정책·절차 수립             │
│ • 로그·패킷 실시간 모니터링         │ • 보안 교육·인식 제고             │
│ • 보안 패치·권한 최소화             │ • 위기 대응 체계 (CSIRT)          │
│ • 위협 인텔리전스 연동              │ • 정기 점검·모의훈련              │
└─────────────────────────────────────┴───────────────────────────────────┘
                              │
                              ▼
              기업 보안솔루션 내 BPFdoor용 침해지표 반영 및
                    사고 예방·대응 능력 강화
```

---

### 📈 상위 토픽 계층도

```
APT / 악성코드
├── 백도어 (Backdoor)
│   ├── 기존 백도어 (포트 기반)
│   └── BPFdoor ← 현재 토픽
│       ├── 스텔스 (매직패킷)
│       ├── 포트리스 (Portless)
│       └── 커널 레벨 동작
├── 랜섬웨어
├── 스피어피싱
└── Lateral Movement
```

---

### ✅ 학습 체크리스트

- [ ] BPFdoor의 정의와 BPF 기술을 설명할 수 있다
- [ ] 기존 백도어와의 차이점(포트, 탐지, 동작계층)을 비교할 수 있다
- [ ] 위협 요소(탐방은다APT)를 나열할 수 있다
- [ ] 기업 시스템에 미치는 영향(보안체계, 시스템, 비즈니스)을 설명할 수 있다
- [ ] 기술적 대응 방안(침로보위)을 알고 있다
- [ ] 관리적 대응 방안(정보위정)을 알고 있다

